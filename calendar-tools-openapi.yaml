openapi: 3.0.3
info:
  title: Gmail and Calendar MCP Tools API
  description: |
    Multi-Tool Calling Protocol (MCP) API for Gmail and Google Calendar integration.
    This API provides tools for managing emails and calendar events through voice commands
    with the GPT-4o-mini-realtime-preview model.
  version: 1.0.0
  contact:
    name: MCP Calendar Tools
    url: https://github.com/your-org/email-ai-voice

servers:
  - url: http://localhost:3000/api/mcp
    description: Local development server

security:
  - sessionAuth: []

paths:
  /list-tools:
    get:
      summary: List all available MCP tools
      description: Returns a list of all available MCP tools including both email and calendar tools
      operationId: listTools
      responses:
        '200':
          description: List of available MCP tools
          content:
            application/json:
              schema:
                type: object
                properties:
                  tools:
                    type: array
                    items:
                      $ref: '#/components/schemas/Tool'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'

  /call-tool:
    post:
      summary: Execute an MCP tool
      description: Execute a specific MCP tool with the provided arguments
      operationId: callTool
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                tool_name:
                  type: string
                  description: Name of the tool to execute
                  example: create_event
                arguments:
                  type: object
                  description: Arguments for the tool
                  additionalProperties: true
              required:
                - tool_name
                - arguments
            examples:
              create_event:
                summary: Create a calendar event
                value:
                  tool_name: create_event
                  arguments:
                    title: "Team Meeting"
                    description: "Weekly team sync meeting"
                    start_time: "2024-01-15T14:30:00"
                    end_time: "2024-01-15T15:30:00"
                    timezone: "America/New_York"
                    location: "Conference Room A"
                    attendees: ["john@example.com", "jane@example.com"]
                    create_meet_link: true
              list_events:
                summary: List upcoming events
                value:
                  tool_name: list_events
                  arguments:
                    maxResults: 10
                    timeMin: "2024-01-15T00:00:00Z"
                    timeMax: "2024-01-22T23:59:59Z"
      responses:
        '200':
          description: Tool execution result
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      type: object
                      properties:
                        type:
                          type: string
                          enum: [text]
                        text:
                          type: string
                          description: JSON-encoded result of the tool execution
              examples:
                create_event_success:
                  summary: Successful event creation
                  value:
                    content:
                      - type: text
                        text: |
                          {
                            "id": "abc123def456",
                            "title": "Team Meeting",
                            "description": "Weekly team sync meeting",
                            "location": "Conference Room A",
                            "start_time": "2024-01-15T14:30:00-05:00",
                            "end_time": "2024-01-15T15:30:00-05:00",
                            "timezone": "America/New_York",
                            "attendees": ["john@example.com", "jane@example.com"],
                            "meet_link": "https://meet.google.com/abc-defg-hij",
                            "calendar_link": "https://calendar.google.com/event?eid=...",
                            "status": "confirmed",
                            "created": "Jan 15, 2024 10:30 AM"
                          }
                list_events_success:
                  summary: Successful event listing
                  value:
                    content:
                      - type: text
                        text: |
                          {
                            "events": [
                              {
                                "id": "abc123def456",
                                "title": "Team Meeting",
                                "description": "Weekly team sync meeting",
                                "location": "Conference Room A",
                                "start_time": "2024-01-15T14:30:00-05:00",
                                "end_time": "2024-01-15T15:30:00-05:00",
                                "timezone": "America/New_York",
                                "attendees": ["john@example.com", "jane@example.com"],
                                "meet_link": "https://meet.google.com/abc-defg-hij",
                                "calendar_link": "https://calendar.google.com/event?eid=...",
                                "status": "confirmed",
                                "created_by": "user@example.com"
                              }
                            ],
                            "summary": "Found 1 upcoming events"
                          }
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'

components:
  securitySchemes:
    sessionAuth:
      type: apiKey
      in: cookie
      name: connect.sid

  schemas:
    Tool:
      type: object
      properties:
        name:
          type: string
          description: Tool name
        description:
          type: string
          description: Tool description
        inputSchema:
          type: object
          description: JSON Schema for tool input parameters
          additionalProperties: true
      required:
        - name
        - description
        - inputSchema

    CalendarEvent:
      type: object
      properties:
        id:
          type: string
          description: Unique event identifier
          example: "abc123def456"
        title:
          type: string
          description: Event title
          example: "Team Meeting"
        description:
          type: string
          description: Event description
          example: "Weekly team sync meeting"
        location:
          type: string
          description: Event location
          example: "Conference Room A"
        start_time:
          type: string
          format: date-time
          description: Event start time in ISO 8601 format
          example: "2024-01-15T14:30:00-05:00"
        end_time:
          type: string
          format: date-time
          description: Event end time in ISO 8601 format
          example: "2024-01-15T15:30:00-05:00"
        timezone:
          type: string
          description: Event timezone
          example: "America/New_York"
        attendees:
          type: array
          items:
            type: string
            format: email
          description: List of attendee email addresses
          example: ["john@example.com", "jane@example.com"]
        meet_link:
          type: string
          format: uri
          description: Google Meet link (if created)
          example: "https://meet.google.com/abc-defg-hij"
        calendar_link:
          type: string
          format: uri
          description: Google Calendar link
          example: "https://calendar.google.com/event?eid=..."
        status:
          type: string
          description: Event status
          enum: [confirmed, tentative, cancelled]
          example: "confirmed"
        created_by:
          type: string
          format: email
          description: Event creator email
          example: "user@example.com"
        created:
          type: string
          description: Event creation timestamp
          example: "Jan 15, 2024 10:30 AM"
        updated:
          type: string
          description: Event last update timestamp
          example: "Jan 15, 2024 10:30 AM"
      required:
        - id
        - title
        - start_time
        - end_time

    CreateEventRequest:
      type: object
      properties:
        title:
          type: string
          description: Event title
          example: "Team Meeting"
        description:
          type: string
          description: Event description (optional)
          example: "Weekly team sync meeting"
        start_time:
          type: string
          format: date-time
          description: Event start time in ISO 8601 format
          example: "2024-01-15T14:30:00"
        end_time:
          type: string
          format: date-time
          description: Event end time in ISO 8601 format
          example: "2024-01-15T15:30:00"
        timezone:
          type: string
          description: Timezone for the event (defaults to UTC)
          example: "America/New_York"
        location:
          type: string
          description: Event location (optional)
          example: "Conference Room A"
        attendees:
          type: array
          items:
            type: string
            format: email
          description: List of attendee email addresses (optional)
          example: ["john@example.com", "jane@example.com"]
        create_meet_link:
          type: boolean
          description: Whether to create a Google Meet link (optional)
          default: false
          example: true
      required:
        - title
        - start_time
        - end_time

    UpdateEventRequest:
      type: object
      properties:
        eventId:
          type: string
          description: Calendar event ID
          example: "abc123def456"
        title:
          type: string
          description: Updated event title (optional)
          example: "Updated Team Meeting"
        description:
          type: string
          description: Updated event description (optional)
          example: "Updated weekly team sync meeting"
        start_time:
          type: string
          format: date-time
          description: Updated start time in ISO 8601 format (optional)
          example: "2024-01-15T15:30:00"
        end_time:
          type: string
          format: date-time
          description: Updated end time in ISO 8601 format (optional)
          example: "2024-01-15T16:30:00"
        timezone:
          type: string
          description: Updated timezone (optional)
          example: "America/New_York"
        location:
          type: string
          description: Updated location (optional)
          example: "Conference Room B"
        attendees:
          type: array
          items:
            type: string
            format: email
          description: Updated list of attendee email addresses (optional)
          example: ["john@example.com", "jane@example.com", "bob@example.com"]
        create_meet_link:
          type: boolean
          description: Whether to add a Google Meet link (optional)
          example: true
      required:
        - eventId

    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
          example: "Authentication required"
        details:
          type: string
          description: Additional error details
          example: "Please authenticate with Google Calendar"

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Tool name is required"

    Unauthorized:
      description: Authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Authentication required"

    ServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Failed to execute tool"

tags:
  - name: Tools
    description: MCP tool management
  - name: Calendar
    description: Calendar event operations
  - name: Email
    description: Email operations 